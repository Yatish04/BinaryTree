version1 : use typed memoryviews whenever possible
version2 : use raw pointers in the bottlenecks